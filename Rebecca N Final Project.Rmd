---
title: "Rebecca N Final Project"
output: html_notebook
author: "Rebecca Neal"
date: " 29 April 2020"
version: "version 1.0"
---

This is for the final exam project in EDRM 718.

### First we will load the package
```{r include=FALSE}
library(tidyverse)

```

### Load the JP Demographics File
```{r}
JP_Demo <- read_csv("Job Prep Demographics.csv", skip = 6,
                    col_names = c("ID", "School", "Age", "Gender", "Discipline"),
                    JP_Demo$ID <- parse_integer(JP_Demo$ID))
                    
```

### Tidy and rename JP_Demo to Demographics File
```{r}
Demographics <- JP_Demo %>%
  fill("Discipline") %>%
  filter(ID >0)

```

### Double check that no ID numbers are repeated
```{r}
check_Demographics <- Demographics %>%
  count(ID) %>%
  filter(n >1)

```
#### Based on this check, we are certain that no ID numbers are repeated

### Load Job Prep Data
```{r}
JP_Data <- read_csv("Job Prep GPA Data.csv", skip = 5,
                    col_names = c("ID", "School", "Age", "Gender", "S1_Credits", "S1_GPA",
                                  "S2_Credits", "S2_GPA"),col_types = cols(S1_GPA = col_double()))
                    
```


### Identify 10% largest residual
```{r}
Top_10 <- JP_Data %>%
  mutate(GPA_Residual = ((S2_GPA - S1_GPA)^2)^(1/2)) %>%
  arrange(desc(GPA_Residual)) %>%
  mutate(Top_10_Residual = cut(GPA_Residual,
                              breaks = c(0,.70,1.36),
                             labels = c("Cool to Use", "Top 10% Residual")))
         
Top_10
```



### Chart showing difference 10% Highest Residuals
```{r}
GPA_Issue_Plot <- Top_10 %>%
  ggplot(aes(x = ID, y = GPA_Residual, color = Top_10_Residual)) +
  geom_point()+
  labs(x = "Student ID Number",
       y = "Difference Between GPA First Semester and Second Semester",
       title = "Top 10% Highest Differences in GPA", 
       subtitle = "Residual Difference in GPA")
  GPA_Issue_Plot

```

### Make Weighted GPA varaible (WA_GPA)
```{r}
GPA_Data <- Top_10 %>%
  mutate(WA_GPA = (((S1_GPA * S1_Credits) + (S2_GPA * S2_Credits)) / 
                     (S1_Credits + S2_Credits)))
GPA_Data
```

### Load in Survey Data
```{r}
JP_Survey <- read_csv("Job Prep Survey Results.csv", skip = 3)
```

### Load in function to Reverse Score
```{r}
Likert_Total <- function(x,y,z){
  Reversed <- abs(x[,c(z)]-y)
  Non_Reversed_Columns <- x[,-z]
  Properly_Scored_Data_Frame <- cbind(Non_Reversed_Columns,Reversed)
  CC <- rowSums(Properly_Scored_Data_Frame)
  Total_Data_Frame <- cbind(Properly_Scored_Data_Frame,CC)
  write.csv("Total_Data_Frame", file = "Total Data Frame.csv", row.names = FALSE)
  return(Total_Data_Frame)
}
```

### Reverse Score with Survey Data
#### This is a little cumbersome, I added 1 to each column # to make it work with
#### the function and the ID number
```{r}
CTR <- c(5,10,13,14)
JP_Survey2 <- Likert_Total(JP_Survey, 7, CTR)
JP_Survey2
```

#### Clean up to remove ID number from the calculated total
```{r}
JP_Survey3 <- JP_Survey2 %>%
  mutate(Optimism_Score = CC - ID)
JP_Survey3



```


#### Add discipline to JP_Survey
```{r}
JP_Survey4 <- JP_Survey3 %>%
  left_join(Demographics, by = "ID")
JP_Survey4
```


### Evaluate if the mean of the Optimism scores by discipline is different
```{r}
Difference_Check <- JP_Survey4 %>%
  group_by(Discipline) %>%
  summarize(count = n(),
            Mean_OS = mean(Optimism_Score, na.rm = TRUE))


```


### Conduct ANOVA test to check for differences in the means
```{r}
JP_Survey4 %>%
  aov(Optimism_Score ~ Discipline)
  
  
  
  
  
```




#### What's Next
```{r}
col_names = c("ID", "School", "Age", "Gender", "Discipline"),
                    JP_Demo$ID <- parse_integer(JP_Demo$ID))

health2 <- health %>%
  left_join(cities, by = "city.code")




```












